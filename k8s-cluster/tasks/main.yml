---

- name: Setup all masters and nodes
  include_role:
    name: k8s-cluster
    tasks_from: deps_conf

# - name: Static IP configuration
#   include_role:
#     name: k8s-cluster
#     tasks_from: float_ip
#   when: hostvars['localhost']['remote_float_ip'] is defined  and inventory_hostname in groups['k8s-workers']
  
- name: Setup masters
  include_role:
    name: k8s-cluster
    tasks_from: master
  when: inventory_hostname in groups['k8s-masters']

- name: Join nodes
  include_role:
    name: k8s-cluster
    tasks_from: worker
